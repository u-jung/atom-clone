var  MapLoaded=false;
var historic_layer;
var map;
var wdArray=[], pWdArray=0;
var inhalt;
var call_count;



jQuery(document).ready(function(){


/***********************************************  Translation ****************************************************************** */		
	
	function getPlaces(coord, overlay){
		var ar=coord.split(",");

		ar[0]=Math.floor(ar[0]*2)/2
		ar[1]=Math.floor(ar[1]*2)/2
		var query={
				   "query": {
					  "filtered": {
						 "query": {
							"match_all": {}
						 },
						 "filter": {
							"bool": {
							   "must": [
								  {
									 "term": {
										"lon": ar[0]
									 }
								  },
								  {
									 "term": {
										"lat":ar[1]
									 }
								  }
							   ]
							}
						 }
					  }
				   }
				
			 ,
			  "size":200000,
			  "sort" : [{ "loc" : {"order" : "asc"}}]
			}
	
		var index="geo";
		var x = queryES(index,query);		

		
	}
	
	
	function queryES(index,query){
		
		/*jQuery.post(document.location.origin+':9200/'+index+'/_search/', JSON.stringify(query), function (data) {
	
			var a=out(data);
		}, 'json');*/
		
		jQuery.post(document.location.origin+':9200/'+index+'/_search/', 
			JSON.stringify(query), 
			function(data, status){
				AjaxResponse(data);
			},
			'json');		
		
	}
	
	
	function AjaxResponse(data){
		
		
		printPlaces(data.hits.hits);		
		/*window.location.replace("http://vm.atom/index.php/informationobject/browse?showAdvanced=0&sq0=Kribi&so1=or&sq1=Bamenda&so2=or&sq2=Garua&so3=or&sq3=Buea&so4=or&sq4=Jabassi&so5=or&sq5=Bertua&so6=or&sq6=Baturi&so7=or&sq7=Lomie&so8=or&sq8=Jokaduma&so9=or&sq9=dume&so10=or&sq10=Joko&topLod=0&rangeType=inclusive")
		*/

		return data;
	}	
	
	
	function printPlaces(hits){
	
		var str
		var line,i,hitslen,result;
		hitslen = hits.length;
		
		jQuery('#popup').css("display","block");

		if (jQuery('#ortsliste').length==0){
			jQuery('#popup-form').prepend(jQuery("<select/>").attr("id","ortsliste").attr("size","10"));
			jQuery('#ortsliste').prop('multiple',true);
		}
		else{
			console.log(jQuery('#ortsliste').length);
			jQuery('#ortsliste option').remove();
			console.log(jQuery('#ortsliste option').size());
			
		}

		for (i = 1; i < hitslen; i++){
			jQuery('#ortsliste').append(jQuery("<option/>").html(hits[i]["_source"]["loc"]).attr("value",jQuery.trim(hits[i]["_source"]["loc"].match(/^[^\(]+/i))).prop("selected",true));
		}		
		
					
	}
	
	
	function lookupPlaces(ar){
		var uStr;

		for (i = 0; i < ar.length; i++){

		}
		var qs=document.location.origin+"/index.php/informationobject/browse?showAdvanced=0";

		for (i = 0; i < ar.length; i++){
			uStr=encodeURIComponent(ar[i]);
			if(i==0){

				console.log(uStr, ar[i], ar);
				qs+="&sq"+i+"="+uStr;
			}
			else{
				qs+="&so"+i+"=or&sq"+i+"="+uStr;
			}
		}
		qs+="&topLod=0&rangeType=inclusive"
		if (ar.length>0){
			
			window.location.replace(qs);	
		}
		else{
			alert("Es wurde nichts ausgewählt");
		}	
			

	}
	
	function showMap(){
		
			if (MapLoaded==true){
				jQuery('#map').css('display','block');
				return;
			}
			
	   /**
		   * Elements that make up the popup.
		   */
			var container = document.getElementById('popup');
			var content = document.getElementById('popup-content');
			var closer = document.getElementById('popup-closer');

		  
		  /**
		   * Create an overlay to anchor the popup to the map.
		   */
		  var overlay = new ol.Overlay({
			element: container,
			autoPan: true,
			autoPanAnimation: {
			  duration: 250
			}
		  });


				  /**
		   * Add a click handler to hide the popup.
		   * @return {boolean} Don't follow the href.
		   */
		  closer.onclick = function() {
			overlay.setPosition(undefined);
			closer.blur();
			return false;
		  };

			

			jQuery('#map').css("display","block");
			jQuery('#map').css("position","absolute");
			var newHeight = (jQuery("html").height() - 150 )  + "px";
			
			jQuery("#map").css("height", newHeight); 
			jQuery("#map").css("z-index", 10); 
		  var vectorSource = new ol.source.Vector({
			url: 'https://openlayers.org/en/v4.6.4/examples/data/geojson/countries.geojson',
			format: new ol.format.GeoJSON()
		  });

		  historic_layer=new ol.layer.Tile({source: new ol.source.OSM({url: '/plugins/arArchivesCanadaPlugin/images/tiles/{z}/{x}/{-y}.png'})});
		  var osm_layer=new ol.layer.Tile({source: new ol.source.OSM()})

		  map = new ol.Map({

				controls: ol.control.defaults().extend([new ol.control.OverviewMap({collapsed:false}), new ol.control.ScaleLine({className: 'ol-scale-line', minWidth:120,target: document.getElementById('scale-line')}), new ol.control.Zoom({minWidth:120})]),


				overlays: [overlay],
				target: 'map',
				layers: [
					osm_layer,        
					historic_layer
				  
				],
				view: new ol.View({
				  center: ol.proj.fromLonLat([11.41, 3.82]),
				  zoom: 4,
				  minZoom: 3,
				  maxZoom: 13
				})
			});
			
		   /*var feature = new ol.Feature({
				geometry: new ol.geom.Polygon([0.0,0.0],[20.0,0.0],[0.0,20.0],[20.0,20.0])
			});

			var rect = new ol.layer.Vector({
				source: new ol.source.Vector({
					features: [feature]
				})
			});
			map.addLayer(rect);
			console.log(feature.getGeometry());

		   */

			var closebutton = document.createElement('close-button');
			closebutton.innerHTML = 'x';

			var handleClose = function(e) {
				jQuery('#map').css('display','none');
			};

			closebutton.addEventListener('click', handleClose, false);

			var element = document.createElement('div');
			element.className = 'closeMap ol-unselectable ol-control';
			element.appendChild(closebutton);

			var CloseControl = new ol.control.Control({
				element: element
			});
			map.addControl(CloseControl);	
			
			
			
		  map.on('singleclick', function(evt) {
			var coordinate = evt.coordinate;
			var coord = ol.coordinate.toStringXY(ol.proj.transform(
				coordinate, 'EPSG:3857', 'EPSG:4326'),1);
			overlay.setPosition(coordinate);
			
			getPlaces(coord);
		  });	
		

	   
		
			map.once('postrender', function(event) {
				MapLoaded=true;
			});
			
			
			
			      // Create the graticule component
			  var graticule = new ol.Graticule({
				// the style to use for the lines, optional.
				strokeStyle: new ol.style.Stroke({
				  color: 'rgba(255,120,0,0.9)',
				  width: 2,
				  lineDash: [0.5, 4]
				}),
				targetSize: 200,
				showLabels: true
			  });
			   /*graticule.setMap(map); */ /*muss noch implementiert werden */  
	
	}


/***********************************************  Wikidata ****************************************************************** */		
	
	function showWD(){
			jQuery('#wd').css("display","flex");
			jQuery('#wd').css("position","absolute");
			var newHeight = (jQuery("html").height() - 150 )  + "px";
			jQuery('#wd-content-container').css("display","block");
			jQuery("#wd").css("height", newHeight); 
			jQuery("#wd").css("z-index", 10); 
	
			
			var data = [
				{
					name: 'Deutsche Kolonien',
					id: "Q329618",
					type: "kolonien"
				},
								{
					name: 'Deutsches Reich',
					id: "Q1206012",
					type: "deutschland"
				}
			];

			
			jQuery('#tree1').tree({
				dragAndDrop: false,
				data: data,
				 buttonLeft: true,
				 saveState: true,
				onCreateLi: function(node, $li) {
					$li.attr('id',"li"+node.id);
					$li.find('.jqtree-element').append('<a href="https://www.wikidata.org/wiki/'+node.id+'"  class="'+node.type+'" target="_blank" >&nbsp;&nbsp;<img src="/plugins/arArchivesCanadaPlugin/images/wikidata.ico"></a> <a  href="#" class="searchFromWd"  id="'+node.id+'" >&nbsp;&nbsp;&nbsp;</a>');
					}
				
			});
			
				// bind 'tree.click' event
				
			jQuery('#tree1').bind(
				'tree.click',
				function(event) {
					// The clicked node is 'event.node'
					
					var node = event.node;
					var wdid= node.id;

					var id= node.id;
					var type=node.type;

					var sub, prop;
					console.log(jQuery('#li'+node.id+ "ul").attr("display"));
					if(jQuery('#li'+node.id+ " ul").length>0){
						if(jQuery('#li'+node.id+ " ul").attr("display")=="block"){
							jQuery('#li'+node.id+ " ul").attr("display", "none")
						}
						else{
							jQuery('#li'+node.id+ " ul").attr("display", "block")
						}
						
					}
					if (type  == "kolonie"){

						sub=[	{name:"Details",type:'detailed_data',id:wdid},
								{name:"Chronologie",type:'chronologie',id:wdid},
								{name:"Personen",type:'personen',id:wdid},
								{name:"Verwaltung", type:'verwaltungen', id:wdid},
								{name:"Unternehmen",type:'firmen', id:wdid},
								{name:"Missionen",type:'missionen', id:wdid},
								{name:"Militär",type:'militaer',id:wdid}					
						]
						loadTreeData(sub,node);
						
					}
					else{
						query=buildWdQuery(type, wdid,prop,culture);
						sub=getFromWd(query[0],node,query[1]);
					}
					jQuery('#tree1').on('click', '.searchFromWd', function(e) {
						/*Start search of WD from Tree node*/
						showLoader();
						searchFromWd(jQuery(this).attr("id"));
					});					
				
				}
				
			);
			
			/*jQuery('#tree1 jqtree-element .searchFromWd'  ).on( "singleclick", function() {alert("Heureka") } );*/
			
			/*console.log(getFromWd(buildWdQuery('kolonien',"Q329618","P361",culture,),'','kolonien'));*/
		
	}
	
	function loadTreeData(data,node){
		jQuery('#tree1').tree('loadData',data,node);
	}
	
	function buildWdQuery(type,subj,prop, lang='de'){
			console.log(type);	
		
		if(type=="kolonien"){
			query='select  ?item ?itemLabel Where { bind(wd:'+subj+' as ?concept).?item wdt:P361  ?concept .  SERVICE wikibase:label { bd:serviceParam wikibase:language "'+lang+',de,en" }} Order BY ?itemLabel';
			type='kolonie';
		}

		

		/*
		if(type=='person'){
			query= 'PREFIX entity: <http://www.wikidata.org/entity/>  \
					SELECT distinct ?propUrl ?propLabel ?valUrl ?valLabel \
					WHERE  \
					{ \
						hint:Query hint:optimizer "None" . \
						{	BIND(entity:'+subj+' AS ?valUrl) . \
							BIND("N/A" AS ?propUrl ) . \
							BIND("identity"@en AS ?propLabel ) . \
						} \
						UNION \
						{	entity:'+subj+' ?propUrl ?valUrl .  \
							?property ?ref ?propUrl .  \
							?property rdf:type wikibase:Property .  \
							?property rdfs:label ?propLabel  \
						} \
						?valUrl rdfs:label ?valLabel \
						FILTER (LANG(?valLabel) = "'+lang+'") . \
						OPTIONAL{ ?valUrl wdt:P18 ?picture .} \
						FILTER (lang(?propLabel) = "'+lang+'" ) \
					} \
					ORDER BY ?propUrl ?valUrl ';
			type='detailed_data';
		}
		*/
		if(type=='person'){type='detailed_data'};
		if(type=='verwaltung'){type='detailed_data'};
				
		if(type == 'detailed_data'){
			query=	'PREFIX entity: <http://www.wikidata.org/entity/> \
					SELECT ?propNumber ?propLabel ?val  \
					WHERE \
					{ \
						hint:Query hint:optimizer "None" . \
						{	BIND(entity:'+subj+' AS ?valUrl) . \
							BIND("N/A" AS ?propUrl ) . \
							BIND("Name"@de AS ?propLabel ) . \
						    entity:'+subj+' rdfs:label ?val . \
						    FILTER (LANG(?val) = "'+lang+'") \ 	} \
						 UNION \
						{ \
						   optional{ \
							 BIND(entity:'+subj+' AS ?valUrl) . \
							 BIND("Image"@de AS ?propLabel ) . \
							 BIND("18000" AS ?propNumber ) . \
							 entity:'+subj+' wdt:P18 ?val. \
						   } \
						}\
						UNION \
						{optional{ ?valUrl schema:about entity:'+subj+'. \
								 ?valUrl schema:inLanguage "de" . \
								BIND("Wikipedia@de"@de AS ?propLabel ) . \
								BIND(str(?valUrl) AS ?val)} \
								BIND("5" AS ?propNumber ) . \
						} \
						UNION{ \
								BIND(str(entity:'+subj+') AS ?val) . \
								BIND("Wikidata"@de AS ?propLabel ) .  \
								BIND("0" AS ?propNumber ) . \
						} \
						UNION \
						{   BIND(entity:'+subj+' AS ?valUrl) . \
							BIND("AltLabel"@de AS ?propLabel ) .  \
							BIND("4" AS ?propNumber ) . \
							optional{entity:'+subj+' skos:altLabel ?val}.  \
							FILTER (LANG(?val) = "'+lang+'")  } \
						UNION \
							{BIND(entity:'+subj+' AS ?valUrl) . \
							BIND("Description"@de AS ?propLabel ) .  \
							BIND("3" AS ?propNumber ) . \
							optional{entity:'+subj+' schema:description ?val}. \
							FILTER (LANG(?val) = "'+lang+'")  \
						} \
						UNION \
						{	entity:'+subj+' ?propUrl ?valUrl . \
							?property ?ref ?propUrl . \
							?property rdf:type wikibase:Property . \
							?property rdfs:label ?propLabel. \
							FILTER (lang(?propLabel) = "'+lang+'") \
							filter  isliteral(?valUrl)  \
							BIND(?valUrl AS ?val) \
						} \
						UNION \
						{	entity:'+subj+' ?propUrl ?valUrl . \
							?property ?ref ?propUrl . \
							?property rdf:type wikibase:Property . \
							?property rdfs:label ?propLabel. \
							FILTER (lang(?propLabel) = "'+lang+'" )  \
							filter  isIRI(?valUrl)  \
							?valUrl rdfs:label ?valLabel  \
							FILTER (LANG(?valLabel) = "'+lang+'")  \
							 BIND(CONCAT(?valLabel) AS ?val) \
						} \
							BIND( SUBSTR(str(?propUrl),38, 250) AS ?propNumber) \
					} \
					ORDER BY xsd:integer(?propNumber)';
			
			
			
			type='detailed_data';
		}
		
		if(type=="zugehoerig"){
			query='SELECT DISTINCT ?item ?itemLabel ?bodyLabel   ?von ?bis ?position  ?bemerkung ?vonPrecision ?bisPrecision \
					{ \
					  bind (wd:'+subj+' as ?body) \
					  ?item wdt:P31 wd:Q5 . \
					  ?item p:P1416 ?position_statement .   \
					  ?position_statement ps:P1416 ?body . \
					  OPTIONAL { ?position_statement pq:P580 ?von} \
					  OPTIONAL { ?position_statement pq:P582 ?bis} \
					  OPTIONAL { ?position_statement pqv:P580 ?vonnode.\
								?vonnode  wikibase:timePrecision     ?vonPrecision. \
								?vonnode  wikibase:timeValue    ?von.   \
								} \
					  OPTIONAL { ?position_statement pqv:P582 ?bisnode.\
								  ?bisnode wikibase:timePrecision     ?bisPrecision.    \
								  ?bisnode wikibase:timeValue     ?bis.  \
						} \
					  OPTIONAL { ?position_statement pq:P106/rdfs:label ?position filter (lang(?position) = "'+lang+'") .  } \
					  OPTIONAL { ?position_statement pq:P2868/rdfs:label ?bemerkung filter (lang(?bemerkung) = "'+lang+'")  } \
					  SERVICE wikibase:label { bd:serviceParam wikibase:language "'+lang+',de" . } \
					} \
					ORDER BY ?von ?position' 
		}
		if (type=="chronologie"){
			query=	'prefix var: <http://www.wikidata.org/entity/'+subj+'>  \
					SELECT ?item  (concat(?typ, ?iLabel) as ?itemLabel) ?von ?bis ?nr  \
					WHERE  \
					{  \
						{var: p:P31 ?statement.  \
						 ?statement ps:P31 ?item.  \
						 ?item rdfs:label ?iLabel.  \
						 bind("" as ?typ)  \
						 bind(1 as ?nr)  \
						 optional{?statement pq:P580 ?von.}  \
						 optional{?statement pq:P582 ?bis.}  \
						  filter (isLiteral((DATATYPE(?von) = xsd:dateTime )|| (DATATYPE(?bis) = xsd:dateTime )))  \
						 FILTER((LANG(?iLabel)) = "de")}  \
					  union  \
						 { var: p:P36 ?statement.  \
						 ?statement ps:P36 ?item.  \
						 ?item rdfs:label ?iLabel.  \
						 bind(3 as ?nr)  \
						 bind("Hauptort: " as ?typ)  \
						 optional{?statement pq:P580 ?von.}  \
						 optional{?statement pq:P582 ?bis.}  \
						 FILTER((LANG(?iLabel)) = "de")}  \
					  union  \
						 { var: p:P131 ?statement.  \
						 ?statement ps:P131 ?item.  \
						 ?item rdfs:label ?iLabel.  \
						 optional{?statement pq:P580 ?von.}  \
						 optional{?statement pq:P582 ?bis.}  \
						 filter (isLiteral((DATATYPE(?von) = xsd:dateTime )|| (DATATYPE(?bis) = xsd:dateTime )))  \
						 bind("Teil von: " as ?typ)  \
						 bind(2 as ?nr)  \
						 FILTER((LANG(?iLabel)) = "de")}  \
					  union  \
						{  \
						var: wdt:P571 ?von.  \
						bind("Gegründet: " as ?typ)  \
						bind("" as ?iLabel)  \
						bind(0 as ?nr)  \
						}  \
					  union  \
						{  \
						var: wdt:P576 ?bis.  \
						bind("Aufgelöst: " as ?typ)  \
						bind("" as ?iLabel)  \
						 bind(4 as ?nr)  \
					  }  \
					}  \
					ORDER BY ?nr ?von'  
		}
		
		/*Reihenfolge beachten Personen -> Person*/
		if(type=='personen'){
			query='select distinct ?item ?itemLabel ?itemDescription where {  ?item wdt:P31 wd:Q5 .  ?item wdt:P937 wd:'+subj+' . SERVICE wikibase:label { bd:serviceParam wikibase:language "'+lang+',de,en". }}order by ?itemLabel';
			type='person';		
		}

		if(type=='verwaltungen'){
			/* match Behörde:Q327333  bzw. Bezirksverwaltungsbehörde:Q854399 bzw. Verwaltungssitz Q1306755*/
			query='select distinct  ?item ?itemLabel ?itemDescription Where  {  bind(wd:'+subj+' as ?concept).  ?item wdt:P361  ?concept .  {{?item wdt:P31/wdt:P279* wd:Q327333 }    UNION {?item wdt:P31/wdt:P279*  wd:Q854399} UNION {?item wdt:P31/wdt:P279*  wd:Q1306755}}    SERVICE wikibase:label { bd:serviceParam wikibase:language "'+lang+',de,en". }  }Order BY ?itemLabel';
			type='verwaltung';	
		}	
		
		if(type=='labels'){
			query='select ?item ?itemLabel ?itemAltLabel Where { bind(wd:'+subj+' as ?item). Optional{?item skos:altLabel ?itemAltLabel . } ?item rdfs:label ?itemLabel   }';
		}
		
		
		if(type=="OneProp"){
			query='select ?item ?itemLabel Where { ?item wdt:'+prop+' wd:'+subj+' SERVICE wikibase:label { bd:serviceParam wikibase:language "'+lang+',de,en" }  } Order by ?itemLabel';			
		}

		console.log(query, type);
			return [encodeURI(query), type];
	
	
	}
	
	
	function getFromWd(query,node, type){
				
			base_url='https://query.wikidata.org/sparql';
		
			url=base_url+"?format=json&query="+query;
		console.log(url);
			showLoader();
			jQuery.get(url,
			function(data, status){
				WdResponse(data,node, type);
				showLoader();
			}).fail(function(){showLoader()});
			return (query);
	}
	
	function WdResponse(data,node, type){
		var nodeData;

		console.log(JSON.stringify(data['results']));
		nodeData=prepareData(data['results']['bindings'],node, type);
		console.log(nodeData);
		if(type=='labels'){
			lookupPlaces(nodeData);
			return;
		}
		if(type=='detailed_data'){

			if(node!=null){
				if(node.parent.type=="verwaltungen"){
					data=[	{name:"Chronologie",type:'chronologie',id:node.id},
							{name:"Zugehörigkeiten", type:'zugehoerig', id:node.id},
							{name:"Untergeordnete Einheiten", type:'untergeordnet', id:node.id},
					]
					loadTreeData(data,node);
				};
			}
			return;
		}
		
		if (["zugehoerig", "chronologie"].indexOf(type)!=-1){
			return;
		}
		/*jQuery('li').find('.jqtree-selected').append(" [" + nodeData.length + "] ");*/
		if(node.name.search("]")<1){
			node.name=node.name + " ["+nodeData.length+"] ";
		}
		
		loadTreeData(nodeData,node);

		}
	
	
	function prepareData(results,node,type){

		var ar;
		var nodeData=[];
		for (i=0; i< results.length;i++){
			nodeData.push({'name':''});
			for(var key in results[i]){
	
				if (key=="itemLabel"){
					nodeData[i]['name']=results[i]['itemLabel']['value'];
				}
				else{
					
					nodeData[i][key]=results[i][key]['value'];
				}
				if(key=="item"){
					nodeData[i]['id']=results[i]['item']['value'].match(/[^\/]*$/i)[0];
				}
			}
			nodeData[i]['type']=type;
		
		}
		
		/*detailed_data*/
		if (type=='detailed_data'){
			console.log(nodeData);
			nodeData=prepareDetails(nodeData,type,"#wd-content");
		    
		}
		
		if (type=='zugehoerig'){
		console.log("zugehoerig");
			nodeData=prepareTable(nodeData, type,'Name', ['bodyLabel','vonPrecision','bisPrecision'],"#wd-content", 1, node.parent.name + " (" + node.name + ")", "person");
			return;
		}
		
		if (type=='chronologie'){

			nodeData=prepareTable(nodeData, type,'', ['nr'],"#wd-content", 1, node.parent.name + " (" + node.name + ")");
			return;
		}
		
		/*Extract WD Labels for search*/
		if(type=='labels'){
			ar=[];
			var uniqLabels=[];
			for(i=0; i< nodeData.length;i++){
				ar.push(nodeData[i].name);
				ar.push(nodeData[i].itemAltLabel);
			}

			jQuery.each(ar, function(i, el){
				if(jQuery.inArray(el, uniqLabels) === -1) uniqLabels.push(el);
			});
			nodeData=uniqLabels;
		};
		
		
		/* Changing the order inside the name field*/
		if(type=='person'){     
			var index, z, n, arStr;
			var ar=[];
				for(i=0; i< nodeData.length;i++){

					arStr=nodeData[i]['name'].toString();
					ar=arStr.split(" ");
					index=ar.indexOf('von')+1;

					if(index==0){
						console.log("len null" + ar.length);
						index=ar.length - 1;
					}
					n="";
							console.log(index);							
					for (j=0;j<index;j++){
									console.log(ar);
						
						ar.push(ar[0]);
						console.log(ar);
						ar.shift();
									console.log(ar);
					}
					for(j=0;j<ar.length;j++){

						if(j==ar.length-index){
							n += ", " + ar[j];
						}
						else{
							n+= " " + ar[j];
						}
					nodeData[i]['name']=n.trim();
						console.log(n);
					}
					
				}
		console.log(JSON.stringify(nodeData));			
			nodeData.sort(function(a, b){
				var nameA=a.name.toLowerCase(), nameB=b.name.toLowerCase()
				if (nameA < nameB) 
					return -1 
				if (nameA > nameB)
					return 1
				return 0 
				})
			
		}
		console.log(JSON.stringify(nodeData));
		/*jQuery('#tree1').tree('loadData', nodeData,node);*/
		return nodeData;
	}
	
	
	/*writes a list of dict into a table*/	
	function prepareTable(data, type,itemTitle, excludeList,target, linked,title, target_type=type){
		console.log(linked);
		/*
		 nodeData: the data array (list of dicts)
		 type: type of data
		 itemTitle: Literal to replace the 'itemLabel' column
		 excludeListe: Array List with columns which should not be included
		 target: target div 
		 linked: boolean if itemLabel should be enriched with links of item
		 title: Title of the table
		 * item should be placed before itemLabel
		 */
		
		var uStr='<h3>'+title+'</h3><table class="zebra">';
		uStr+="<tr>";
		for (var key in data[0]){
				if ((["item","type","id"].indexOf(key)==-1 ) && (excludeList.indexOf(key)==-1) ){
					if(key=="itemLabel"){
						uStr+=itemTitle;
					}
					else{
							uStr+="<th>"+key.charAt(0).toUpperCase() + key.slice(1)+"</th>";
					}
				}
		}			
		uStr+="<th></th></tr>";
		for(i=0; i< data.length;i++){
			uStr+="<tr>";
			for (var key in data[i]){

				console.log((["item","type","id"].indexOf(key)==-1 ) && (excludeList.indexOf(key)==-1));
				if((["item","type","id"].indexOf(key)==-1 ) && (excludeList.indexOf(key)==-1)){
					console.log(key,itemTitle);
					if(key.toLowerCase()==itemTitle.toLowerCase()){
						if (linked==1){
							uStr+="<td>"+'<a href="#" id="'+data[i]['item'].match(/[^\/]*$/i)[0]+'|'+target_type+'" >'+data[i][key]+'</a>'+"</td>";
						}
						else{
							uStr+="<td>"+data[i][key]+"</td>";
						}
						
					}
					else{
							uStr+="<td>"+testDate(data[i][key], data[i][key+"Precision"])+"</td>";

					}
				}
			}
			uStr+="</tr>";
		}
		uStr+="</table>";
		if (data.length ==0){uStr+="<p>Keine Daten vorhanden</p>"};

		writeDiv(target,uStr, type);
		return uStr;
	};
	
	/*manage the wd div*/
	function writeDiv(target,uStr, type){
		jQuery(target).html("");
		if(typeof(uStr)=="string"){
			jQuery(target).append(uStr);
			wdArray.push(uStr);
			console.log(wdArray);
			pWdArray=wdArray.length-1;		
		}
		else{
			elementId=uStr;
			
			console.log(wdArray.length, pWdArray, elementId);
			if(jQuery(elementId).attr("id")=="wd-back"){
				if(pWdArray>0){pWdArray-=1};
			}else
			{
				if(pWdArray<wdArray.length-1){pWdArray+=1};
			}
			jQuery(target).append(wdArray[pWdArray]);
		}
		
		
		;

			
	}
	
	
	
	/*Prepares the output of wd-content details*/
	function prepareDetails(data,type,target){
		var uStr = "<dl>", logo;
		var content, label;
		var trenner=" :  ";
		var arUri=getAuthorityURI();
		var prop=0;
	
		console.log(arUri);
		for(i=0; i< data.length;i++){

			content=data[i].val;
			label=data[i].propLabel;
			prop=data[i].propNumber;
			console.log(label);
			if (label==null || label==undefined){
				label=" ";
				content=".";
				continue;
			}
			console.log(content, label, trenner);
			var index;
			if (label=="Name"){
				content="<b>"+content+"</b>";
		
				trenner="";
			}
			if (content.substr(0,4).toLowerCase()=="http"){
				content='<a href="'+content+'" target="_blank">'+content+"</a>";
				
	
			}
			if (label=="Description"){
				content=""+content+"";

				trenner="";
			}
			if (label=="Wikidata"){
				logo='<a target="_blank" href="'+data[i].val+'" ><img src="/plugins/arArchivesCanadaPlugin/images/wikidata.png"/></a>';
				continue;
				
			}
			/*if (label=="Image"){
				content='<img src="'+content+'" />';
				label="";
				trenner="";
			
			}*/

			/*if (label=="Image4"){
				content='';
				label="";
				trenner="";
				content=content.match(/[^\/]*$/i)[0];

				jQuery.ajax( {
					url: "https://www.mediawiki.org/w/api.php?action=query&format=json&prop=imageinfo&titles=File:"+content+"&iiprop=url&iiurlwidth=100",
					data:"",
					dataType: 'json',
					type: 'POST',
					headers: { 'Api-User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36' },
					success: function(data) {
					   // do something with data
					},
					error:function(data){
						console.log("error");
						
					}
				} );
			}*/
			index=arUri.indexOf(parseInt(prop))
			console.log(index, prop);
			if(index>-1){
				content='<a href="'+arUri[index+1].replace("$1",content)+'" target="_blank">'+content+'</a>';
			}
			
			uStr+='<dt>'+label+"</dt><dd>"+testDate(content)+"</dd>";
		
		}
		uStr+="</dl>" + logo;
		writeDiv(target,uStr, type);
		return uStr;
	}
	
	/*https://www.mediawiki.org/w/api.php?action=query&format=json&prop=imageinfo&titles=File:Von%20Puttkamer%20in%20full%20dress.jpg&iiprop=url&iiurlwidth=100&origin=*  */
	
	
	
	function searchFromWd(id){
	
		var labels;
		
		labels=getLabels(id);
	}
	
	
	function getLabels(id){
	
		getFromWd(buildWdQuery('labels',id,"", culture)[0],"", 'labels');
	};
	
	function showLoader(){
		console.log(jQuery('.loader').css("display"));
		var newLeft= Math.floor((jQuery("html").width() / 2 - 200  ) ) + "px";
		jQuery(".loader").css("left", newLeft); 
		if (jQuery('.loader').css("display")=="none"){
			jQuery('.loader').css("display", "block")
		}
		else{
			jQuery('.loader').css("display", "none")
		}
	}
	
	
	function testDate(wdDate,precision="9"){
		if (wdDate.match(/[0-9-]{10}T[0-9:]{8}Z/i) == null){return wdDate};
		var year = wdDate.slice(0,4);
		var month=wdDate.slice(5,7);
		var day= wdDate.slice(8,10);
		if (precision=="9"){return year};
		if (precision=="10"){return month +'/'+year};
		return day + "." +month +'.'+year;
	}
	
/***********************************************  Translation ****************************************************************** */	
	function showTranslation(clickedWord){
			call_count+=1;
			
			console.log(clickedWord);
			clickedWord=clickedWord.match(/[a-zäöüßéàáêèôûâëïîæńṅṁçõãœ]*/i)[0];	
			clickedWord=encodeURI(clickedWord);
			showLoader();
		    var page = clickedWord;
		    var baseURL = 'http://de.wiktionary.org';
			jQuery('#wikiInfo').html('...please wait...');
			jQuery.getJSON(baseURL+'/w/api.php?action=parse&format=json&prop=text|revid|displaytitle&callback=?&page='+page,
			function(json) {
				showLoader();
				console.log(json);
			  console.log(json['error']==undefined);
			  if(json['error']==undefined) {
				txt3=prepTranslation(json.parse.text['*'], [])

			  } else {
				if (clickedWord!=clickedWord.toLowerCase()){
					call_count-=1;
					showTranslation(clickedWord.toLowerCase());
				}
				jQuery('#popup-translation-content').html("");
				jQuery('#popup-translation-content').html('word not found');
				/*jQuery('#popup-translation-content').hide();*/
			  }
			})
		
		};
	
	function prepTranslation(txt, t){
		var out;
		var item;
		
		var h=jQuery.parseHTML(txt);
		h[0]['childNodes'].forEach(function(item,index){
			if(["H2","H3", "P", "H4", "DIV", "DL"].indexOf(item.nodeName)>-1){
				t.push([item.nodeName,item.innerText.trim()]);
				};		
			});


			for (i=0;i<t.length-1;i++){
				
				if(t[i][0]=="H2"){
					out+="<h2>"+t[i][1].replace("[Bearbeiten]","")+"</h2>"
				}
				if(t[i][0]=="H3"){
					out+="<h3>"+t[i][1].replace("[Bearbeiten]","")+"</h3>"
				}
				if (t[i][1]=="Bedeutungen:"){
					item=t[i+1][1]
				
					item=item.replace(new RegExp('\r?\n','g'), '<br />');

					item=item.replace("<br /><br />","<br />");
					out+="<p>"+item+"</p>"
				}
				if (t[i][1]=="Grammatische Merkmale:"){
					
					item=t[i+1][1]
					item=item.replace(new RegExp('\r?\n','g'), '<br />');

					item=item.replace("<br /><br />","<br />");
					if(call_count<2){
						if (item.indexOf("flektierte")>-1){

							return showTranslation(item.match(/([a-zäöüßéàáêèôûâëïîæńṅṁçõãœ]*)\./i)[1].trim(":").trim(")").trim("("));
							
							}
					}
					out+="<p>"+item+"</p>"
				}
				if (t[i][0]=="H4"){
					
					item=t[i+1][1]
					console.log(encodeURI(item));
					item=item.replace(/([a-zäöüßéàáêèôûâëïîæńṅṁçõãœå\)\(\u00a0]*)\u00a0→\u00a0([\w\)\(\ ]*)/img,'<a href="http://$2.wiktionary.org/wiki/\$1" target="blank">\$1</a>');
					/*item=item.replace(/\u00a0([\w])h/mg,"$1");*/
					item=item.replace(new RegExp('\n\n','g'), '\n');
					item=item.replace(new RegExp('\n\n','g'), '\n');
					item=item.replace(new RegExp('\r?\n','g'), '<br />');
					
					item=item.replace("<br /><br />","<br />");
					out+="<p>"+item+"</p>"
				}
			}
			;
			console.log(out);
			
			out=out.replace("undefined","");
			jQuery('#popup-translation-content').html("");
			
			jQuery('#popup-translation-content').html(out);
			return out;
	}	
	
	
	
	
	
	function switchTranslationMode(element){
				console.log(jQuery("#lookup img").attr("src"));
				console.log(element);
				console.log(jQuery("#lookup img").attr("alt"));	
		if (jQuery("#lookup img").attr("alt")=="aus"){

			jQuery("#lookup img").attr("alt", "ein");
			jQuery("#lookup img").attr("src", "/plugins/arArchivesCanadaPlugin/images/book_green.png");
			jQuery('#content').css('cursor', 'help');
			   content=jQuery('#content').html();
			   				
			   jQuery('#content p, #content a, #content li').html(function () {
					var cont = [];
					return "<span>" + jQuery(this).text().split(" ").join("</span> <span>") + "</span>";
				  }).on("click", "span", function(event) {
					call_count=0;
					jQuery('#popup-translation').css('display',"block");			
					var clickedWord = jQuery(this).text();
					console.log(clickedWord);
					showTranslation(clickedWord);
				  });
			jQuery('#popup-translation').css('position',"fixed");	
			jQuery('#popup-translation').css('left',0);      // <<< use pageX and pageY
			jQuery('#popup-translation').css('top',jQuery('#content').css("top"));
			console.log(jQuery('#content'));
			jQuery('#popup-translation').css('width',(jQuery('#content').position().left-25) +"px");
			jQuery('#popup-translation-content').css('height',(screen.height - 300)+"px");
			jQuery('#popup-translation').css('display',"block");	
			jQuery('#popup-translation').css('z-index',"50");	
			jQuery('#popup-translation').css('padding',"10");			
			jQuery('#popup-translation').css('background-color',"rgb(248, 245, 14)");	
					
		console.log(jQuery('#content').position().left);
		
		}
		else{
			jQuery("#lookup img").attr("alt", "aus");
			jQuery("#lookup img").attr("src", "/plugins/arArchivesCanadaPlugin/images/book_red.png");
			jQuery('#content').css('cursor', 'default');
			jQuery('#content').html(inhalt);
			jQuery('#content').off("mouseover", "span");
			jQuery('#popup-translation').css("display","none");
		}
						jQuery('#popup-translation-content').html("");	
		
	}	
	
	
/**********************************************************/	
	
	jQuery(document).on("click","#wd-content table a", function(){
			var ar=this.id.split('|');

		 	query=buildWdQuery(ar[1], ar[0],"",culture);
			sub=getFromWd(query[0],jQuery('#tree1').tree('getNodeById', ar[0]),query[1]);
		 ;});
  
	
	jQuery('#popup-search').click(function () {

		var ar=[];
		
		jQuery('#ortsliste option:selected').each(function(){
			ar.push(jQuery(this).val());
		});
		lookupPlaces(ar);
	});
	
	jQuery('#popup-select').click(function () {

		alert('HI!');

	});
	
	
	jQuery('#mapfinder-sidebar').click(function(){
			showMap();
      
	}); 

	jQuery('#map-toogle').click(function(){
			if(historic_layer.getOpacity()==1){
				historic_layer.setOpacity(0);
				}
			else{
				historic_layer.setOpacity(1);
			}
	}); 
	
	jQuery('#map-merge').click(function(){
				historic_layer.setOpacity(0.5);
			
	}); 

	jQuery('#mapfinder a').click(function(){
			showMap();
      
	}); 

	
	jQuery('#wdfinder a').click(function(){
		showWD();
	})

	jQuery('#wdfinder-sidebar').click(function(){
		showWD();
	})
	jQuery('#map-close').click(function(){
		jQuery('#map').css("display","none");
	})

	jQuery('#wd-close').click(function(){
		jQuery('#wd').css("display","none");
	})

	jQuery('#wd-back').click(function(){
		writeDiv("#wd-content",this,"");
	})
	jQuery('#wd-forward').click(function(){
		writeDiv("#wd-content",this,"");
	})

	jQuery('#lookup').click(function(){

		switchTranslationMode(this);
		
	})




	jQuery('#translation-popup-closer').click(function(){

		switchTranslationMode(this);
		
	})




	/*jQuery('#tree1').click(function(e){
		manipulate_tree(e.node);
	})*/

/***********************************************************************************************************************/


	function getAuthorityURI(){
		return 	[4389,'https://collection.sciencemuseum.org.uk/people/$1'
				,4394,'http://braininfo.rprc.washington.edu/centraldirectory.aspx?ID=$1'
				,4395,'http://braininfo.rprc.washington.edu/centraldirectory.aspx?type=h&ID=$1'
				,4427,'http://id.agrisemantics.org/gacs/C$1'
				,4440,'http://catalogo.iib.unam.mx/F/-/?func=find-b&find_code=SYS&local_base=BNM10&format=999&request=$1'
				,4460,'http://formats.kaitai.io/$1/'
				,4466,'http://astrothesaurus.org/uat/$1'
				,4515,'https://www.prisma.de/$1'
				,4520,'https://suncat.ac.uk/serials/SCID$1'
				,4531,'https://chineseposters.net/artists/$1.php'
				,4549,'https://arlima.net/no/$1'
				,4553,'http://www.racollection.org.uk/ixbin/indexplus?_IXACTION_=file&_IXFILE_=templates/full/person.html&_IXTRAIL_=Names%C2%A0A-Z&person=$1'
				,4558,'http://sig.mapama.es/93/ClienteWS/snczi/default.aspx?nombre=PRESA&claves=DGAGUA.PRESAS.CODPRESA&valores=$1'
				,4574,'http://histreg.no/index.php/person/$1'
				,4589,'http://www.dreadnoughtproject.org/tfs/index.php/$1'
				,4591,'http://www.veterans.gc.ca/eng/remembrance/memorials/national-inventory-canadian-memorials/details/$1'
				,4613,'http://esu.com.ua/search_articles.php?id=$1'
				,4636,'https://v2.sherpa.ac.uk/id/funder/$1'
				,4662,'http://www.san.beniculturali.it/web/san/dettaglio-soggetto-conservatore?codiSan=san.cat.sogC.$1'
				,4694,'http://www.arquivo.arq.br/$1'
				,4696,'https://ciqual.anses.fr/#/aliments/$1'
				,4726,'http://signal.sciencespo-lyon.fr/revue/$1'
				,4729,'http://nut.entecra.it/646/tabelle_di_composizione_degli_alimenti.html?idalimento=$1&quant=100'
				,4750,'http://www.nationalhistoricships.org.uk/register/$1/'
				,213, 'http://isni.org/isni/$1'
				,214,'https://viaf.org/viaf/$1'
				,227,'https://d-nb.info/gnd/$1'
				,244,'https://id.loc.gov/authorities/$1'
				,268,'http://catalogue.bnf.fr/ark:/12148/cb$1'
				,269,'https://www.idref.fr/$1'
				,270,'http://opac.calis.edu.cn/aopac/ajsp/detail.jsp?actionfrom=1&actl=CAL++$1'
				,349,'https://id.ndl.go.jp/auth/ndlna/$1'
				,377,'http://www.n2yo.com/satellite/?s=$1'
				,409,'https://nla.gov.au/anbd.aut-an$1'
				,428,'http://www.ipni.org/ipni/advAuthorSearch.do?find_abbreviation=$1'
				,458,'https://www.marinetraffic.com/ais/details/ships/$1'
				,486,'https://id.nlm.nih.gov/mesh/$1.html'
				,486,'https://meshb.nlm.nih.gov/#/record/ui?ui=$1'
				,493,'http://www.icd9data.com/getICD9Code.ashx?icd9=$1'
				,494,'http://apps.who.int/classifications/icd10/browse/2016/en#/$1'
				,502,'http://tools.wmflabs.org/wikidata-externalid-url/?p=502&url_prefix="http://www.nhc.noaa.gov/archive/&id=$1"'
				,508,'http://thes.bncf.firenze.sbn.it/termine.php?id=$1'
				,563,'http://codes.iarc.fr/search.php?cx=009987501641899931167%3A2_7lsevqpdm&cof=FORID%3A9&ie=UTF-8&ie=ISO-8859-1&oe=ISO-8859-1&sa=&q=$1'
				,586,'http://www.ipni.org/ipni/idAuthorSearch.do?id=$1'
				,587,'https://www.marinetraffic.com/ais/details/ships/$1'
				,646,'https://g.co/kg$1'
				,648,'https://openlibrary.org/works/$1'
				,650,'https://rkd.nl/en/explore/artists/$1'
				,672,'http://id.nlm.nih.gov/mesh/$1'
				,686,'http://amigo.geneontology.org/amigo/term/$1'
				,691,'http://aut.nkp.cz/$1'
				,691,'https://aleph.nkp.cz/F/?func=find-c&local_base=aut&ccl_term=ica=$1&CON_LNG=ENG'
				,731,'https://litholex.bgr.de/gesamt_ausgabe_neu.php?id=$1'
				,863,'https://inpho.cogs.indiana.edu/$1.html'
				,906,'https://libris.kb.se/auth/$1'
				,918,'http://www5.hrsdc.gc.ca/noc/english/noc/2011/Profile.aspx?val=7&val1=$1'
				,919,'http://tools.wmflabs.org/wikidata-externalid-url/?p=919&url_prefix="http://www.bls.gov/soc/2010/soc&url_suffix=.htm&id=$1"'
				,920,'http://id.sgcb.mcu.es/Autoridades/$1/concept.html'
				,949,'http://aleph.nli.org.il/F/?func=find-b&local_base=NNL10&find_code=SYS&con_lng=eng&request=$1'
				,950,'http://datos.bne.es/resource/$1'
				,951,'http://viaf.org/processed/NSZL%7C$1'
				,1005,'http://urn.bn.pt/nca/unimarc-authorities/txt?id=$1'
				,1006, 'http://opc4.kb.nl/PPN?PPN=$1'
				,1014,'http://vocab.getty.edu/page/aat/$1'
				,1015,'https://authority.bibsys.no/authority/rest/authorities/html/$1'
				,1017,'https://viaf.org/viaf/sourceID/BAV|$1'
				,1036,'http://dewey.info/class/$1/'
				,1047,'http://www.catholic-hierarchy.org/bishop/b$1.html'
				,1051,'http://psh.techlib.cz/skos/PSH$1'
				,1149,'http://id.loc.gov/authorities/classification/$1.html'
				,1150,'http://rvk.uni-regensburg.de/regensburger-verbundklassifikation-online#notation/$1'
				,1207,'https://viaf.org/processed/NUKAT|$1'
				,1256,'http://iconclass.org/$1'
				,1273,'http://cantic.bnc.cat/registres/CUCId/$1'
				,1284,'https://www.munzinger.de/search/go/document.jsp?id=$1'
				,1294,'http://www.worldwildlife.org/ecoregions/$1'
				,1296,'https://www.enciclopedia.cat/EC-GEC-$1.xml'
				,1315,'http://trove.nla.gov.au/people/$1'
				,1362,'http://tls.theaterwissenschaft.ch/wiki/$1'
				,1375,'http://katalog.nsk.hr/F/?func=direct&doc_number=$1&local_base=nsk10'
				,1385,'http://www.culturacores.azores.gov.pt/ea/pesquisa/Default.aspx?id=$1'
				,1394,'http://glottolog.org/resource/languoid/id/$1'
				,1402,'http://xiphoid.biostr.washington.edu/fma/fmabrowser-hierarchy.html?fmaid=$1'
				,1417,'https://www.britannica.com/$1'
				,1453,'http://www.catholic.ru/modules.php?name=Encyclopedia&op=content&tid=$1'
				,1550,'http://www.orpha.net/consor/cgi-bin/OC_Exp.php?lng=EN&Expert=$1'
				,1645,'http://physics.nist.gov/cgi-bin/cuu/Value?$1'
				,1670,'https://www.collectionscanada.gc.ca/canadiana-authorities/index/view?index_name=cdnAutNbr&search_text=$1&page=1&cdnAutNbr=$1'
				,1695,'http://mak.bn.org.pl/cgi-bin/KHW/makwww.exe?BM=01&IM=04&NU=01&WI=$1'
				,1711,'https://collection.britishmuseum.org/id/person-institution/$1'
				,1755,'http://aviation-safety.net/database/record.php?id=$1'
				,1760,'http://aviation-safety.net/wikibase/wiki.php?id=$1'
				,1769,'http://denkxweb.denkmalpflege-hessen.de/cgi-bin/mapwalk.pl?event=Query.Details&obj=$1'
				,1807,'http://www.enciclopedia-aragonesa.com/voz.asp?voz_id=$1'
				,1819,'http://www.genealogics.org/getperson.php?personID=$1&tree=LEO'
				,1900,'http://www.eagle-network.eu/voc/$1'
				,1928,'http://www.ontobee.org/browser/rdf.php?o=VO&iri="http://purl.obolibrary.org/obo/$1"'
				,1938,'https://www.gutenberg.org/ebooks/author/$1'
				,1946,'http://catalogue.nli.ie/Record/$1'
				,2004,'http://lod.nal.usda.gov/nalt/$1'
				,2026,'https://avibase.bsc-eoc.org/species.jsp?avibaseid=$1'
				,2106,'http://www.rsc.org/publishing/journals/prospect/ontology.asp?id=$1'
				,2158,'http://purl.obolibrary.org/obo/$1'
				,2163,'http://id.worldcat.org/fast/$1'
				,2179,'https://dl.acm.org/buildccscode.cfm?id=$1&lid=f'
				,2263,'http://www.isocat.org/rest/dc/$1'
				,2347,'http://www.yso.fi/onto/yso/p$1'
				,2355,'http://www.unesco.org/languages-atlas/en/atlasmap/language-id-$1.html'
				,2357,'https://nces.ed.gov/ipeds/cipcode/cipdetail.aspx?y=55&cip=$1'
				,2367,'http://dbforms.ga.gov.au/pls/www/geodx.strat_units.sch_full?wher=stratno=$1'
				,2372,'http://www.odis.be/lnk/$1'
				,2397,'https://www.youtube.com/channel/$1'
				,2452,'http://www.geonames.org/ontology#$1'
				,2457,'https://dmzapp17p.ris.environment.gov.au/shipwreck/public/wreck/wreck.do?key=$1'
				,2464,'http://bugguide.net/node/view/$1'
				,2477,'https://www.tbrc.org/#!rid=$1'
				,2479,'https://spdx.org/licenses/$1.html'
				,2581,'http://babelnet.org/synset?word=bn:$1'
				,2612,'https://www.ted.com/topics/$1'
				,2671,'https://g.co/kg$1'
				,2689,'http://bartoc.org/en/node/$1'
				,2742,'http://www.ga.gov.au/provexplorer/provinceDetails.do?eno=$1'
				,2748,'https://www.nationalarchives.gov.uk/pronom/$1'
				,2751,'http://rcdb.com/$1.htm'
				,2752,'http://www.nzor.org.nz/names/$1'
				,2760,'http://archive.foodstandards.gov.au/consumerinformation/nuttab2010/nuttab2010onlinesearchabledatabase/onlineversion_code.cfm?&action=getFood&foodID=$1'
				,2812,'http://mathworld.wolfram.com/$1.html'
				,2863,'http://www.molendatabase.nl/nederland/molen.php?nummer=$1'
				,2866,'http://www.molens.nl/nl/molen/zoek-een-molen/zoekresultaten-molenbestand/molendetail/?molenid=$1'
				,2867,'http://www.molenechos.org/molen.php?AdvSearch=$1'
				,2874,'https://pubchem.ncbi.nlm.nih.gov/bioassay/$1'
				,2924,'https://bigenc.ru/text/$1'
				,2950,'http://nomisma.org/id/$1'
				,3021,'http://www.iranicaonline.org/articles/$1'
				,3040,'https://soundcloud.com/$1'
				,3064,'http://www.nhm.ac.uk/jdsml/research-curation/research/projects/lepindex/detail.dsml?TaxonNo=$1'
				,3065,'http://data.rero.ch/$1'
				,3074,'http://www.gracesguide.co.uk/$1'
				,3088,'http://taibnet.sinica.edu.tw/chi/taibnet_species_detail.php?name_code=$1'
				,3088,'http://taibnet.sinica.edu.tw/eng/taibnet_species_detail.php?name_code=$1'
				,3102,'http://www.plantarium.ru/page/view/item/$1.html'
				,3105,'http://www.tela-botanica.org/bdtfx-nn-$1'
				,3106,'https://www.theguardian.com/$1'
				,3123,'http://plato.stanford.edu/entries/$1'
				,3130,'http://plantnet.rbgsyd.nsw.gov.au/cgi-bin/NSWfl.pl?page=nswfl&lvl=sp&name=$1'
				,3133,'http://nektar.oszk.hu/auth/$1'
				,3180,'https://vndb.org/$1'
				,3183,'http://topics.wsj.com/$1'
				,3201,'http://purl.bioontology.org/ontology/MEDDRA/$1'
				,3221,'https://www.nytimes.com/topic/$1'
				,3222,'https://www.ne.se/uppslagsverk/encyklopedi/lång/$1'
				,3235,'http://philpapers.org/browse/$1'
				,3240,'https://data.nbn.org.uk/Taxa/$1'
				,3241,'http://www.newadvent.org/cathen/$1.htm'
				,3265,'https://myspace.com/$1'
				,3267,'https://www.flickr.com/photos/$1'
				,3285,'http://www.ams.org/mathscinet/msc/msc2010.html?t=$1'
				,3289,'https://web.expasy.org/cellosaurus/$1'
				,3308,'https://lib.reviews/thing/$1'
				,3322,'https://www.vlinderstichting.nl/vlinders/overzicht-vlinders/details-vlinder/?vlinder=$1'
				,3328,'http://www.wurvoc.org/vocabularies/om-1.8/$1'
				,3347,'https://permid.org/1-$1'
				,3348,'http://nlg.okfn.gr/resource/authority/record$1'
				,3365,'http://www.treccani.it/enciclopedia/$1'
				,3370,'http://www.geopatronyme.com/nomcarte/$1'
				,3381,'http://fileformats.archiveteam.org/wiki/$1'
				,3390,'http://unicat.nlb.by/opac/pls/dict.prn_ref?tu=r&tq=v0&name_view=va_all&a001=BY-NLB-ar$1&strq=l_siz=20'
				,3398,'http://www.butterfliesandmoths.org/$1'
				,3400,'http://cordis.europa.eu/projects/$1'
				,3420,'http://www.calflora.org/cgi-bin/species_query.cgi?where-calrecnum=$1'
				,3430,'http://snaccooperative.org/ark:/99166/$1'
				,3479,'http://www.aftonbladet.se/tagg/$1'
				,3545,'http://www.theoi.com/$1.html'
				,3552,'https://connectonline.asic.gov.au/RegistrySearch/faces/landing/panelSearch.jspx?searchType=OrgAndBusNm&searchText=$1'
				,3553,'https://www.zhihu.com/topic/$1'
				,3579,'http://weibo.com/$1'
				,3583,'http://www.surfline.com/surfaz/surfaz.cfm?id=$1'
				,3591,'http://wcsp.science.kew.org/namedetail.do?name_id=$1'
				,3710,'http://www.daat.ac.il/encyclopedia/value.asp?id1=$1'
				,3720,'https://www.gpnotebook.co.uk/simplepage.cfm?ID=$1'
				,3724,'https://www.ushmm.org/wlc/en/article.php?ModuleId=$1'
				,3762,'https://openmlol.it/autore/$1'
				,3763,'http://www.mimo-db.eu/InstrumentsKeywords/$1'
				,3790,'http://animecons.com/guests/bio.shtml/$1'
				,3794,'http://dictionaryofsydney.org/$1'
				,3795,'http://flora.org.il/plants/$1'
				,3798,'http://www.starwars.com/databank/$1/'
				,3827,'https://www.jstor.org/topic/$1'
				,3832,"http://www.europeanafashion.eu/portal/browse.html#objectType%3D'http%3A%2F%2Fthesaurus.europeanafashion.eu%2Fthesaurus%2F$1"
				,3847,'https://openlibrary.org/subjects/$1'
				,3854,'http://www.soundtrackcollector.com/title/$1/'
				,3859,"https://www.ebi.ac.uk/ols/ontologies/envo/terms?iri=http://purl.obolibrary.org/obo/ENVO_$1"
				,3885,'http://www.histmodbiomed.org/taxonomy/term/$1'
				,3895,'http://www.inao.gouv.fr/produit/$1'
				,3905,'http://data.culture.fr/thesaurus/page/ark:/67717/$1'
				,3911,'http://zbw.eu/stw/descriptor/$1'
				,3916,'http://vocabularies.unesco.org/thesaurus/$1'
				,3941,'http://www.iaa-archives.org.il/search.aspx?loc_id=$1'
				,3943,'https://$1.tumblr.com/'
				,3964,'http://bibliotecadigital.jcyl.es/en/consulta_aut/registro.cmd?id=$1'
				,3964,'http://bibliotecadigital.jcyl.es/es/consulta_aut/registro.cmd?id=$1'
				,3964,'http://bibliotecadigital.jcyl.es/fr/consulta_aut/registro.cmd?id=$1'
				,3973,'https://resolver.pim.hu/auth/$1'
				,3984,'https://www.reddit.com/r/$1/'
				,3986,'http://www.sequenceontology.org/browser/current_svn/term/$1'
				,3998,'http://censoarchivos.mcu.es/CensoGuia/archivodetail.htm?id=$1'
				,4003,'https://www.facebook.com/pages/$1'
				,4051,'http://zakon5.rada.gov.ua/laws/show/$1'
				,4073,'http://$1.wikia.com/'
				,4104,'http://data.carnegiehall.org/names/$1'
				,4106,'http://www.kyppi.fi/to.aspx?id=112.$1'
				,4125,'http://titan.gbif.fr/sel_genann1.php?numero=$1'
				,4160,'https://restaurant.michelin.fr/$1'
				,4167,'https://www.dn.no/topic/$1'
				,4180,'http://gujlit.com/profile.php?pId=$1'
				,4201,'https://www.pagesjaunes.fr/pros/$1'
				,4204,'http://timesofindia.indiatimes.com/topic/$1'
				,4223,'http://www.treccani.it/enciclopedia/$1_(Enciclopedia-Italiana)/'
				,4228,'http://www.eoas.info/biogs/$1.htm'
				,4255,'http://en.banglapedia.org/index.php?title=$1'
				,4272,'https://dp.la/search?subject%5B%5D=$1'
				,4293,'http://purl.org/pressemappe20/folder/$1'
				,4294,'http://www.crd.york.ac.uk/PROSPERO/display_record.asp?ID=$1'
				,4297,'https://spatialillusions.com/unitgenerator.html#$1'
				,4304,'https://id.erfgoed.net/thesauri/materialen/$1'
				,4305,'https://id.erfgoed.net/thesauri/stijlen_en_culturen/$1'
				,4306,'https://id.erfgoed.net/thesauri/datering/$1'
				,4307,'https://id.erfgoed.net/thesauri/erfgoedtypes/$1'
				,4308,'https://id.erfgoed.net/thesauri/waardetypes/$1'
				,4309,'https://id.erfgoed.net/thesauri/gebeurtenistypes/$1'
				,4310,'https://id.erfgoed.net/thesauri/besluittypes/$1'
				,4311,'https://id.erfgoed.net/thesauri/soorten/$1'];
						
		
	}


/*end of jQuery.document(ready)*/

});

